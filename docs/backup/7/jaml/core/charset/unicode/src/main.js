export class Unicode {
    /**
     * Unicodeレベルの正規化とサニタイズ
     * @param {string} text
     * @returns {string}
     */
    static normalize(text) {
        if (!text) return '';

        // 1. NULLバイトの削除 (セキュリティ対策: ヌルバイト攻撃防止)
        let normalized = text.replace(/\0/g, '');

        // 2. Unicode正規化 (NFC)
        // 【重要】CJK統合漢字の問題により無効化中
        // normalize('NFC')を実行すると、異体字（例: 神 -> 神）が統合文字に変換され、
        // 原稿の意図した字形が失われる可能性があります。
        
        // 3. その他のセキュリティリスクについて
        // Unicodeには、見た目が同じでも異なる文字コードを使用する「ホモグラフ攻撃」や、
        // 不正なバイトシーケンスによる攻撃リスクが存在します。
        // これらを完全に防ぐには、膨大なUnicode文字の組み合わせを網羅的にチェックする必要があり、
        // 10万字規模のテキスト処理において著しいパフォーマンス低下を招きます。
        // また、言語や文脈によって「正当な文字」の定義が異なるため、ライブラリレベルでの一律排除は困難です。
        // したがって、本ライブラリではヌルバイト削除等の最低限のサニタイズに留め、
        // 高度なセキュリティチェックは上位レイヤーまたは専用のセキュリティツールに委譲します。
        
        // normalized = normalized.normalize('NFC');

        return normalized;
    }
}
